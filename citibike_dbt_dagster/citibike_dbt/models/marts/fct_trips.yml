version: 2

models:
  - name: fct_trips
    description: "Fact table for Citibike Trips along with total trip amoumt"
    columns:

      - name: trip_key
        data_type: varchar
        description: "Unique hash value generated by creating a surrogate key"
        tests:
          - not_null

      - name: trip_duration
        data_type: number
        description: "The time taken for the entire trip in seconds"
        tests:
          - not_null
          - positive_value

      - name: start_time
        data_type: timestamp_ntz
        description: "Start time and date of the trip"

      - name: stop_time
        data_type: timestamp_ntz
        description: "Stop time and date of the trip"

      - name: start_station_id
        data_type: number
        description: "Unique id of the start station"
        tests:
          - relationships:
              to: ref('dim_station')
              field: station_id

      - name: end_station_id
        data_type: number
        description: "Unique id of the end station"
        tests:
          - relationships:
              to: ref('dim_station')
              field: station_id

      - name: bike_id
        data_type: number
        description: "Unique bike id corresponding to the trip"

      - name: membership_type
        data_type: varchar
        description: "Type of membership, Customer = 24-hour pass or 3-day pass user; Subscriber = Annual Member"
        tests:
          - accepted_values:
              values: ['null','Customer', 'Subscriber']

      - name: user_type
        data_type: varchar
        description: "Type of user - Zero=unknown; 1=male; 2=female"
        tests:
          - accepted_values:
              values: [0,1,2]

      - name: birth_year
        data_type: number
        description: "Year of birth of the customer"

      - name: gender
        data_type: number
        description: "Gender of the customer- Zero=unknown; 1=male; 2=female"
        tests:
          - accepted_values:
              values: [0,1,2]

      - name: trip_amount
        data_type: number
        description: "Total cost of the trip in USD generated from trip_price_calc macro. It has price and price_per_min which is coming from src_pricing_and_plan model "
        tests:
          - not_null
          - positive_value